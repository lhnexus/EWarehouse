<!DOCTYPE html>
<html>
<head>
    <title>Testing animations</title>
    <meta charset="utf-8" />
    <script src="http://cdn.leafletjs.com/leaflet-0.6.1/leaflet.js"></script>
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="http://d3js.org/topojson.v1.min.js"></script>

    <style>
        #info {
            background-color:#5499C7;
    </style>
</head>
<body>
<div id="info"style="height: 600px;width: 960px;"></div>
<script>
    var minArea, curColor;

    var svg = d3.select("#info").append("svg")
        .attr("width", 960)
        .attr("height", 600)
        .attr("stroke",'rgb(175,122,197)');

    var rect = svg.append('rect').attr('x',0).attr('y',300).attr('width',100).attr('height',50).style('fill','rgb(255,0,255)').style('stroke','rgb(209,242,235)').style('stroke-width','5');

    animation();

    function animation() {
        svg.transition()
            .duration(7500)
            .tween("precision", function() {
                var areax = d3.interpolateRound(50, 450);
                var areay = d3.interpolateRound(300,300);
                var color = d3.interpolateRgb('rgb(255,0,255)', 'rgb(0,255,0)');
                return function(t) {
                    minAreax = areax(t);
                    minAreay = areay(t);
                    curColor = color(t)
                    render();
                };
            })
            .transition()
            .duration(3500)
            .tween("precision", function() {
                var areax = d3.interpolateRound(450, 450);
                var areay = d3.interpolateRound(300,300);
                var angle = d3.interpolateRound(0,-90);
                var color = d3.interpolateRgb('rgb(0,255,0)', 'rgb(255,0,255)');
                return function(t) {
                    minAreax = areax(t);
                    minAreay = areay(t);
                    curColor = color(t);
                    minAngle = angle(t);
                    renderRotate();
                };
            })
            .transition()
            .duration(3500)
            .tween("precision", function() {
                var areax = d3.interpolateRound(450, 450);
                var areay = d3.interpolateRound(300,100);
                var color = d3.interpolateRgb('rgb(0,255,0)', 'rgb(255,0,255)');
                return function(t) {
                    minAreax = areax(t);
                    minAreay = areay(t);
                    curColor = color(t)
                    render();
                };
            })
            .transition()
            .duration(3500)
            .tween("precision", function() {
                var areax = d3.interpolateRound(450, 350);
                var areay = d3.interpolateRound(100,100);
                var color = d3.interpolateRgb('rgb(0,255,0)', 'rgb(255,0,255)');
                return function(t) {
                    minAreax = areax(t);
                    minAreay = areay(t);
                    curColor = color(t)
                    render();
                };
            })
            .transition()
            .duration(3500)
            .tween("precision", function() {
                var areax = d3.interpolateRound(350, 450);
                var areay = d3.interpolateRound(100,100);
                var color = d3.interpolateRgb('rgb(0,255,0)', 'rgb(255,0,255)');
                return function(t) {
                    minAreax = areax(t);
                    minAreay = areay(t);
                    curColor = color(t)
                    render();
                };
            })
            .transition()
            .duration(3500)
            .tween("precision", function() {
                var areax = d3.interpolateRound(450, 450);
                var areay = d3.interpolateRound(100,300);
                var color = d3.interpolateRgb('rgb(0,255,0)', 'rgb(255,0,255)');
                return function(t) {
                    minAreax = areax(t);
                    minAreay = areay(t);
                    curColor = color(t)
                    render();
                };
            })
            .transition()
            .duration(7500)
            .tween("precision", function() {
                var areax = d3.interpolateRound(450, 50);
                var areay = d3.interpolateRound(300,300);
                var color = d3.interpolateRgb('rgb(255,0,255)', 'rgb(0,255,0)');
                return function(t) {
                    minAreax = areax(t);
                    minAreay = areay(t);
                    curColor = color(t)
                    render();
                };
            })
            .transition()
            .duration(2500)
            .each("end", animation);
    }

    function render() {
        var n = 0;

        var color = 'rgb(' + curColor.r + ',' + curColor.g + ',' + curColor.b + ')';
        rect.attr('x',minAreax).attr('y',minAreay).style('fill','rgb(84,153,199)');

        console.log(color)

        //text.text(formatArea(minArea) + "px² / " + formatPercent(n / m));
    }
    function renderRotate() {
        var n = 0;

        var color = 'rgb(' + curColor.r + ',' + curColor.g + ',' + curColor.b + ')';
        rect.attr('x',minAreax).attr('y',minAreay).style('fill','rgb(84,153,199)').attr('transform','rotate('+minAngle+',500,325)');

        console.log(color)

        //text.text(formatArea(minArea) + "px² / " + formatPercent(n / m));
    }

</script>
</body>
</html>